# 🖐️ 팀 소개

- ## 팀명 : **명짝**
- ### 팀원 소개 :

<table>
<tr>

<!-- 김승룡 -->
<td align="center" width="200" style="vertical-align: top; padding: 15px;">
  <h3 style="margin: 10px 0 5px 0;">김승룡</h3>
  <p style="margin: 5px 0;">프롬프트 엔지니어링 (페르소나 설정, 답변 스타일 조정), README 작성</p>
  <a>
    <img width="780" height="1200" alt="image" src="https://github.com/user-attachments/assets/380a6eb5-2175-4398-9ef6-f16a8dfe836a" />
  </a>
</td>

<!-- 정덕규 -->
<td align="center" width="200" style="vertical-align: top; padding: 15px;">
  <h3 style="margin: 10px 0 5px 0;">정덕규</h3>
  <p style="margin: 5px 0;">Retrieval(검색) 로직 구현 (유사도 검색, MMR 등)</p>
  <a>
    <img width="252" height="204" alt="image" src="https://github.com/user-attachments/assets/e7def1d2-a95b-4f7b-a513-bf1da56a2dd6" />
  </a>
</td>

<!-- 이의정 -->
<td align="center" width="200" style="vertical-align: top; padding: 15px;">
  <h3 style="margin: 10px 0 5px 0;">이의정</h3>
  <p style="margin: 5px 0;">Vector DB Engineer, streamlit 구현</p>
  <a>
    <img width="252" height="204" alt="image" src="https://github.com/user-attachments/assets/aa63258d-2caf-48ee-b1ed-7485f80ab58d" />
  </a>
</td>

<!-- 진승언 -->
<td align="center" width="200" style="vertical-align: top; padding: 15px;">
  <h3 style="margin: 10px 0 5px 0;">진승언</h3>
  <p style="margin: 5px 0;">데이터엔지니어 + 환각(Hallucination) 제어 및 답변 테스트</p>
  <a>
    <img width="252" height="204" alt="image" src="https://github.com/user-attachments/assets/045f7d1f-5d7e-4c1f-97bd-09646aacbb5b" />
  </a>
</td>

<!-- 이명준 -->
<td align="center" width="200" style="vertical-align: top; padding: 15px;">
  <h3 style="margin: 10px 0 5px 0;">이명준</h3>
  <p style="margin: 5px 0;">RAG retrieval 로직, LLM 모델 선정 및 LangChain 파이프라인(Chain) 구성 </p>
  <a>
    <img width="512" height="512" alt="image" src="https://github.com/user-attachments/assets/fdce2560-003c-4fb4-af5a-f7f1c3349a70" />
  </a>
</td>

</tr>
</table>

<br>

---

# 📖 프로젝트 개요

##  주제 : 모두가 관심있어하는, 인류 생존에 가장 중요한 연애! <br> 어떻게 하면 더 나은 연애를 할 수 있을지 상담해주는 AI 기반의 '연애 상담' 챗봇 서비스

- ###  **프로젝트 소개**

"**명짝 : 명준(님) 짝꿍구하기**"는 사용자의 연애에 대한 고민을 상담해주는 AI 대화형 챗봇 서비스입니다.  
**연애를 하면서 생기는 다양한 상황과 질문에 대한 답변를 RAG 기반으로 안내**하며  
**사용자가 선호하는 연애 유튜버의 말투로 답변**합니다.

- ###  **프로젝트 배경**

"연애를 하다보면, 또는 연애를 시작하려고 하면<br>
남들에게 물어보기도 어려운 다양한 상황에 직면하게 됩니다.<br>
이럴 때 저희 AI 챗봇에 물어보면 됩니다.."<br>

## 본 프로젝트가 필요한 이유
### 연애 고민은 혼자 감당하기엔 너무 크다
- 사소해 보여도 감정·자존감·판단력을 흔들며, 주변에 말하기도 어렵다.
### 감정 때문에 생각이 왜곡된다
- 불안, 자기비난, 과한 해석 속에서 스스로 객관화가 힘들다.
### 사람 상담의 한계를 보완한다
- 지인 상담의 편향, 전문가 상담의 비용·접근성 문제를 해결한다.
### 결정 직전 타이밍을 잡아준다
- 연락·답장·이별 같은 순간에 감정 폭주를 막아준다.
### 정답 없는 연애를 구조화해준다
- 상황 분석 → 선택지 → 결과 예측까지 정리해준다.
### 반복되는 연애 패턴을 인식하게 한다
- 기록과 정리를 통해 ‘왜 힘든지’를 언어화하게 돕는다.

## 관련 기사

### ■ 모쏠 공대남, 5천명과 미팅 후 결혼까지…챗GPT가 다 했다


<img width="745" height="485" alt="image" src="https://github.com/user-attachments/assets/13ba213d-1feb-4dcc-a57d-5b70fe784c0d" />


- 러시아 개발자, AI로 '데이트 최적화' 프로포즈, 결혼 계획까지 AI에 맡겨

[https://www.asiae.co.kr/article/2024020110103092016](https://www.asiae.co.kr/article/2024020110103092016)
##### 출처: 아시아경제

<br>

#### => 연애는 하고 싶지만, 어떻게 해야할지 모르고, 어떤 얘기를 해야할지 모르겠는 사람이 많음.
	
### "이러한 배경에서 저희는 **연애 전문가(연애 유튜브)의 말투로 상황에 따른 대답을 해주는 AI 챗봇의 필요성**을 느끼고 도움을 줄 수 있는 챗봇을 구상하게 되었습니다."

- ### **프로젝트 목표**

1.  **핵심 정보 제공**: 연애하면서 맞닥뜨리게 되는 다양한 상황에 대한 대처법을 정확하게 답변해줌
    
2.  **맞춤형 대화**: 감정·기억을 반영한 개인화된 상담 제공
    
3.  **RAG 기반 정확성 향상**: GPT-4o-mini + Qdrant으로 근거 기반 답변 생성
    
4.  **명준(님), 의정(님) 짝꿍 구하기**: 명준(님)의 여자친구, 의정(님)의 남자친구를 구하는 것이 최종적인 프로젝트의 목적

<br>

---

# 💻 기술 스택 & 사용한 모델  

| 분야                | 사용 도구 |
|---------------------|-----------|
| **Language**        | [![Python](https://img.shields.io/badge/Python-3776AB?style=for-the-badge&logo=Python&logoColor=white)](https://www.python.org/) |
| **Collaboration Tool** | [![Git](https://img.shields.io/badge/Git-F05032?style=for-the-badge&logo=git&logoColor=white)](https://git-scm.com/) [![GitHub](https://img.shields.io/badge/GitHub-181717?style=for-the-badge&logo=github&logoColor=white)](https://github.com/) [![Discord](https://img.shields.io/badge/Discord-5865F2?style=for-the-badge&logo=discord&logoColor=white)](https://discord.com/) |
| **LLM Model**       | [![GPT-4o](https://img.shields.io/badge/GPT--4o-mini%20-412991?style=for-the-badge&logo=openai&logoColor=white)](https://platform.openai.com/) 
| **Embedding Model** | [![text-embedding-3-small](https://img.shields.io/badge/text--embedding--3--small-00A67D?style=for-the-badge&logo=openai&logoColor=white)](https://platform.openai.com/docs/guides/embeddings) |
| **Vector DB**       | [![Pinecone](https://img.shields.io/badge/qdrant-0075A8?style=for-the-badge&logo=qdrant&logoColor=white)](https://qdrant.tech/) |
| **Retrieval**       | [![MMR](https://img.shields.io/badge/mmr-0075A8?style=for-the-badge&logo=mmr&logoColor=white)](https://www.cs.cmu.edu/~jgc/publication/The_Use_MMR_Diversity_Based_LTMIR_1998.pdf) [![BM25](https://img.shields.io/badge/bm25-0075A8?style=for-the-badge&logo=bm25&logoColor=white)](https://en.wikipedia.org/wiki/Okapi_BM25) [![ReRanker](https://img.shields.io/badge/reranker-0075A8?style=for-the-badge&logo=reranker&logoColor=white)](https://huggingface.co/BAAI/bge-reranker-v2-m3) ![HuggingFace](https://img.shields.io/badge/huggingface-%23FFD21E.svg?style=for-the-badge&logo=huggingface&logoColor=white)
| **Orchestration / RAG** | [![LangChain](https://img.shields.io/badge/LangChain-1C3C3C?style=for-the-badge&logo=langchain&logoColor=white)](https://www.langchain.com/) |
| **Development Env** | [![VS Code](https://img.shields.io/badge/VS%20Code-007ACC?style=for-the-badge&logo=visualstudiocode&logoColor=white)](https://code.visualstudio.com/) [![Conda](https://img.shields.io/badge/Conda-3EB049?style=for-the-badge&logo=anaconda&logoColor=white)](https://www.anaconda.com/)

<br>

---

# 🪢시스템 아키텍처

### 프로젝트 구조

<img width="600" height="400" alt="project_struct" src="https://github.com/user-attachments/assets/bf13e19d-902e-410e-b711-208b94098379" />


<br>

### 프로젝트 동작 과정
**1. Preprocessing**: 국내 연애 유튜버 관련 유튜브 콘텐츠들의 음성을 텍스트로 변환하여 JSON 형태로 제작 후 Qdrant를 이용하여 Vector DB로 저장

**2. Retrieval**: BM25, MMR, ReRank을 활용하여 Hybrid 형태로 검색 구현. 
- Vector DB에 저장된 메타데이터의 항목들을 Payload로 호출하여 Document 형태로 로컬에 저장. 
- MMR과 BM25을 Hybrid로 계산 후 이를 Cross-Encoder 기반 ReRanker로 활용함

**3. Prompt**: 각 유튜버의 시스템 프롬프트를 만들 때 ChatGPT를 사용하였고 챗봇에 적용할 때 전체 시스템 프롬프트로 저장함. <br>
이를 통하여 사용자는 원하는 스타일의 유튜버를 선택하여 이에 유튜버의 어조, 성향, 말투로 답변 받을 수 있음. 

**4. Chain**: LLM 모델의 config 초기 설정 기반으로 검색된 문서들을 하나의 문자열로 결합. Retriever와 prompt를 입력받아 RAG 파이프라인을 구성. <br>
Context와 Question을 병렬로 처리하여 프롬프트에 전달하면 전체 체인을 구성할 수 있음.
(순서: Retrieval -> Prompt -> LLM -> OutputParser)


<br>

---

# 🗃️ 수집한 데이터 및 전처리 요약

### 수집한 데이터 목록
연애 유튜버들의 영상 URL 링크 수집.
#### 데이터 수집한 연애 유튜버 이름
- 권승현
- 오늘의 주우재
- 강탱의 이야기
- 연애언어 TV
- 김달

### 전처리 요약
**데이터 수집 방법** : 각 연애 유튜버들의 채널을 방문하여 영상을 클릭한 후, 영상들의 URL 링크들을 불러옴.<br>
불러온 링크들을 이용하여 유튜브 영상들을 사운드 파일로 다운로드 한 후, json 포맷으로 용도에 맞게 변환

<br>

---

# 💾DB 연동

Vectorstore는 수업 시간에 배운 Qdrant를 이용

Collection에 JSON 형식으로 저장하였고 클라이언트가 호출하고 싶은 경우 payload로 부를 수 있음
Vector DB에는 metadata 키로 맵핑하여 qdrant api에서 부를 때 document 형식에 맞게 객체를 생성

<img width="700" height="300" alt="image" src="https://github.com/user-attachments/assets/624fa771-7960-4bb5-b1a2-0c528b0ed093" />

<br>

---

# 💡 테스트 계획 및 결과 보고서

### 유튜버 선택 및 테스트
같은 질문에 대해, 선택한 유튜브에 따라 다른 답변변
#### 질문 : 여자친구가 화났을 때 풀어주는 방법 추천해줘
##### 답변 1 - 권승현 스타일 답변
지금 상황은 여자친구가 화가 난 상태야. 

그녀가 화난 이유는 뭔가 너한테 실망했거나, 불만이 쌓였다는 거야. 이건 그냥 감정이 아니라, 너한테 뭔가를 요구하고 있다 는 신호야. 화가 난 사람은 대개 자신의 감정을 표현하고 싶어 하거든.

이 상황은 너한테 불리해. 여자친구가 화가 나면, 너는 그녀의 감정을 다루는 데 더 많은 에너지를 써야 해. 그리고 그녀가 불만을 품고 있으면, 너는 그 불만을 해소하기 위해 더 많은 노력을 해야 할 수도 있어.

지금 이대로 가면, 그녀의 불만이 쌓여서 관계가 더 나빠질 수 있어. 결국에는 서로의 감정이 더 상하게 될 거고, 그럼 너도  힘들어질 거야.

그래서 지금 당장 해야 할 행동은, 그녀와 진지하게 대화하는 거야. "무슨 일인지 말해줘"라고 솔직하게 물어봐. 그녀의 감정 을 듣고, 그에 대해 진지하게 반응해줘. 이건 단순한 대화가 아니라, 너의 진정성을 보여주는 기회야.

##### 답변 2 - 김달 스타일 답변
여자친구가 화났을 때, 그 감정이 어떤 것인지 먼저 살펴보는 것이 중요합니다. 화가 나면 보통 불안, 서운함, 혹은 상처받은 감정이 뒤섞여 있을 수 있어요. 이런 감정은 그 상황에서 충분히 생길 수 있는 자연스러운 반응입니다.

여자친구가 화가 난 이유는 여러 가지가 있을 수 있습니다. 예를 들어, 당신의 말이나 행동이 그녀에게 상처를 주었거나, 혹은 그녀가 기대했던 것과 다른 상황이 발생했을 수도 있죠. 이런 맥락을 이해하는 것이 중요합니다. 그녀의 감정이 왜 생겼는지 를 생각해보면, 그 상황을 좀 더 잘 이해할 수 있을 거예요.

만약 이런 감정이 오래 지속된다면, 그녀는 점점 더 지치고, 관계에 대한 불신이 생길 수 있습니다. 그래서 지금 이 순간, 그 녀의 감정을 진지하게 받아들이고, 그에 대해 이야기하는 것이 필요합니다.

여자친구에게 다가가서, 그녀의 기분을 물어보는 것이 좋습니다. "무슨 일이 있었는지 이야기해줄 수 있어?"라고 부드럽게 물 어보면, 그녀가 마음을 열고 이야기할 수 있는 기회를 줄 수 있습니다. 이때, 당신이 그녀의 감정을 존중하고 이해하려는 태도를 보이는 것이 중요해요.

마지막으로, 이 관계가 당신에게 안전한지 스스로에게 질문해보세요. 그녀의 감정이 당신에게 어떤 영향을 미치고 있는지, 그 리고 당신이 그녀의 감정을 어떻게 받아들이고 있는지를 생각해보는 것이 필요합니다. 이런 과정을 통해 서로의 마음을 더 잘 이해할 수 있을 거예요.

---
# 시스템 프롬프트 작성
각 유튜버 별로 시스템 프롬프트를 만들고,<br>
전체적인 챗봇의 시스템 프롬프트를 만든 후,<br>
사용자가 유튜버를 선택하면, 해당 유튜버의 말투로 답변해주도록 함.
## 말투를 참고하기 위해 적용한 유튜버 목록
- 권승현
- 오늘의 주우재
- 강탱의 이야기
- 연애언어 TV
- 김달
- 랄라브루스
- 준우
- 박코
- 모두의지인
- 김유신
- 오은영 박사
- 홍차 TV
- 마튜브
<br>
chatgpt에게 시스템 프롬프트를 만들어 달라고 하면서, 프롬프트를 고도화.

## 답변 시 반영할 유튜버의 요소
- 성격 및 태도
- 말투 (존댓말 / 반말 여부)
- 자주 사용하는 단어와 표현
- 사고방식과 세계관
- 논리 전개 구조
- 예시 및 상황 설명 방식
- 비유 스타일
- 조언 방식과 결론 처리


---
# 🐛 트러블슈팅

### qdrant와 Langchain 의 DB 저장 및 조회 방식의 차이때문에 생겨난 에러
- 해결 방법 1. DB의 payload를 metadata라는 키로 묶는 랩핑으로 해결.
- 해결 방법2. langchain 의 load 함수를 쓰지 않고, qdrant api에서 불러오고 document 생성 폼에 맞게 객체 수정
- 해결 방법1의 시간비용과 llm api 호출 비용때문에 해결방법 2로 시도
### Retrieval에 대한 중복된 결과 발생 및 실행 속도 저하
langchain-qdrant 라이브러리에 있는 hybrid 모드에서는 자동으로 겹치는 point를 누락시키지만,<br>
hybrid mode를 직접 구현하여 MMR + BM25 별로 조회한 후 합칠 때 중복되는 결과가 도출됨.<br>
게다가 RAG의 정확도를 위해 Cross-encoder 기반 ReRank를 적용하였으나 실행 속도가 느려지는 현상을 발견함.
- 해결 방법: Parameter tuning 작업 중에 있으므로 추후 개선 예정
### 답변이 지나치게 딱딱하고 로봇스러움
- 해결방법 1. 프롬프트 템플릿에 연애 유튜버나상담가 등 대중적으로 유명한 사람의 이름을 명시하여 유명인의 어투를 따라할 수 있게함.
- 해결방법 2. 프롬프트 템플릿에 사람과 대화할 때 사용하는 말투를 쓰라고 명시하여, 답변의 뉘앙쓰를 바꿈.
### chatgpt가 해당 유튜버를 잘 모름
chatgpt를 이용하여 해당 유튜버들에 대한 시스템 프롬프트 생성시,<br>
권승현, 주우재, 김달은 chatgpt가 알고 있었지만,<br>
다른 유튜버들을 chatgpt가 잘 몰라서,(질문시 유튜버에 대해 모르면 모른다고 답변하라고 함)<br>
해당 유튜브의 채널에 있는 동영상에서 스크립트를 하나 다운받아서,<br>
스크립트도 같이 입력하여 해당 유튜버에 대한 시스템 프롬프트 생성


<br>

---

# 🤖 수행결과(시연 페이지)
<img width="1114" height="349" alt="image" src="https://github.com/user-attachments/assets/d528d03a-7f43-4210-a3bc-ca21cfd02017" />
<img width="1382" height="691" alt="image" src="https://github.com/user-attachments/assets/2717a664-720b-4752-89b0-52ac56bd4d36" />



<br>

---

# ✒️ 한 줄 회고

| 이름 | 회고 |
|----------|-------------|
| 김승룡 |  이번에 시스템 프롬프트를 만들면서, 프롬프트 엔지니어링이라는 것을 처음으로 해봤는데, chatgpt의 답변이 작은 문장의 변화에도 점점 구체화되고 고도화되는 것을 보고 신기하고 재미있었습니다. |
| 정덕규 |  이번에 Chatbot의 RAG의 중요한 Retrieval(검색) 부분을 담당하면서 실습으로 구현한 것 외에 느낀 점이 많았습니다. 최적의 성능을 도출하기 위해 Hybrid 방법으로도 시도하였으나 성능 저하 및 중복값이 발견되는 경우가 있었습니다. 처음에 단순한 검색 구현이라서 메소드만 호출하면 된다고 생각했었으나 Qdrant의 JSON으로 저장된 metadata를 payload를 해야 했고 Langchain UI를 직접 모니터링하면서 비교 분석을 하면서 다각도로 Retrieval에 대한 인사이트를 키울 수 있었습니다. 팀원들의 적극적인 도움으로 설계 및 구현에 대한 시각이 달라졌고 앞으로 이 시점에서 어떻게 개선해 나가야할지 목표가 보였습니다. 
| 이의정 |  이번 프로젝트를 통해서 챗봇의 내부흐름을 제대로 알게되었고 성능개선을 하면서 많은 부분을 배웠던 시간이였던 거 같습니다. |
| 진승언 |  |
| 이명준 |  |
















